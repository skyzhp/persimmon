webpackJsonp([11],{393:function(t,e,a){"use strict";function n(t){a(481)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(416),i=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,function(){return o[t]})}(r);var s=a(483),l=a.n(s),c=a(6),m=n,d=c(i.a,l.a,!1,m,null,null);e.default=d.exports},416:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(19),o=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default={data:function(){var t=this;return{listData:[],categorys:[],currentPage:1,total:0,pageSize:20,myForm:{id:0,name:"",url:"",email:"",markdown:""},myRules:{name:[{required:!0,type:"string",message:"请填写链接名称",trigger:"blur"}],email:[{required:!0,type:"string",message:"请填写邮箱",trigger:"blur"}],markdown:[{required:!0,type:"string",message:"请填写评论内容",trigger:"blur"}]},editFormVisible:!1,editFormLoading:!1,listLoading:!1,myFormTitle:"编辑",checkedAll:[],tableColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"title",render:function(t,e){return t("div",[t("div",{attrs:{class:"comment-avatar"}},[t("p",[t("img",{attrs:{src:"https://cn.gravatar.com/avatar/"+e.row.md5+"?d=identicon&s=60"}})])]),t("div",{attrs:{class:"comment-item"}},[t("p",{},[t("a",{attrs:{href:e.row.url}},e.row.name)]),t("p",{},[t("a",{attrs:{href:"mailto:"+e.row.email}},e.row.email)]),t("p",e.row.ipaddress)])])}},{title:"评论内容",key:"content",render:function(t,e){return t("div",{domProps:{innerHTML:e.row.content}})}},{title:"发表于",key:"posts",render:function(t,e){return t("span",e.row.title)}},{title:"日期",key:"created_at",render:function(t,e){return t("span",o.default.timeFormat(e.row.created_at))}},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleEdit(a.row)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.handleDistory("one",a.row)}}},"删除")])}}],sizeOpts:[10,20,30,40,50,60,70,80,90,100]}},methods:{getData:function(){var t=this;t.listLoading=!0,o.default.ajax.get("/backend/comments",{params:{rows:t.pageSize,page:this.currentPage}}).then(function(e){var a=e.data;200==a.status?(t.listData=o.default.emailToMd5(a.list.data),t.total=a.list.total,t.currentPage=a.list.current_page,t.listLoading=!1):t.$Notice.warning({message:"数据获取失败",type:"error",duration:3e3})}).catch(function(t){console.log(t)})},handleSizeChange:function(t){this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleCreate:function(){var t=this;t.myFormTitle="新增",t.myForm.id=0,t.editFormVisible=!0},handleEdit:function(t){var e=this;e.editFormLoading=!0,e.myFormTitle="编辑",e.editFormVisible=!0,o.default.ajax.get("/backend/comments/"+t.id).then(function(t){var a=t.data;200==a.status?e.myForm=a.item:e.$Notice.warning({message:"数据获取失败",type:"error"}),e.editFormLoading=!1}).catch(function(t){console.log(t),e.editFormLoading=!1})},handleDistory:function(t,e){var a=this,n={};switch(t){case"one":if(parseInt(e.id)<=0)return a.$Notice.warning({message:"请选择需要删除的数据",type:"warning"}),!1;n={ids:[e.id]};break;case"multi":var i=o.default.getIdByArr(a.checkedAll);if(i.length<=0)return a.$Notice.warning({message:"请选择需要删除的数据",type:"warning"}),!1;n={ids:i}}a.$Modal.confirm({title:"确认删除选中的记录吗?",content:"<p>您确认删除选中的记录吗?</p>",onOk:function(){a.listLoading=!0,o.default.ajax.post("/backend/comments/destroy",o.default.stringify(n)).then(function(n){a.listLoading=!1;var i=n.data;if(a.$Notice.warning({title:200==i.status?"删除成功":"删除失败",desc:""}),"one"==t)o.default.removeByValue(a.listData,e.id);else for(var r in a.checkedAll)o.default.removeByValue(a.listData,a.checkedAll[r].id)}).catch(function(t){console.log(t)})},onCancel:function(){a.listLoading=!1}})},submitMyForm:function(){var t=this;t.$refs.myForm.validate(function(e){if(!e)return console.log("myForm valid error."),!1;t.myForm.id>0?o.default.ajax.post("/backend/comments/update",o.default.stringify(t.myForm)).then(function(e){var a=e.data;t.$Notice.open({title:200==a.status?"编辑成功":"编辑失败",desc:""}),200==a.status&&(t.closeForm("myForm"),t.getData())}).catch(function(t){console.log(t)}):o.default.ajax.post("/backend/links",t.myForm).then(function(e){var a=e.data;200==a.status&&(t.closeForm("myForm"),t.getData()),t.$Notice.warning({title:200==a.status?"新增成功":"新增失败",desc:""})}).catch(function(e){if(e.response){if(422==e.response.status)for(var a in e.response.data)t.$Notice.warning({title:"警告",desc:e.response.data[a][0]})}else console.log(e)})})},closeForm:function(){this.editFormVisible=!1,this.$refs.myForm.resetFields(),this.myForm={id:0,name:"",url:"",logo:"",group:""},console.log("closeForm")},selectRow:function(t){this.checkedAll=t},selectAll:function(t){this.checkedAll=t}},watch:{},mounted:function(){this.getData()}}},481:function(t,e,a){var n=a(482);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(23)("59af6963",n,!0,{})},482:function(t,e,a){e=t.exports=a(22)(!1),e.push([t.i,"\n.links {\n  text-decoration: none;\n  color: #000;\n}\n.comment-avatar img {\n  border-radius: 50%;\n}\n.myForm {\n  width: 100% !important;\n}\n",""])},483:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pit-content"},[a("div",{staticClass:"pit-action-btn"},[a("Button",{attrs:{type:"primary",icon:"delete"},on:{click:function(e){t.handleDistory("multi",{})}}},[t._v("删除")])],1),t._v(" "),a("div",{staticClass:"data-list"},[a("Table",{attrs:{loading:t.listLoading,columns:t.tableColumns,data:t.listData,stripe:""},on:{"on-select":t.selectRow,"on-select-all":t.selectAll}})],1),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"myp-page",attrs:{total:t.total,"page-size":t.pageSize,current:t.currentPage,"page-size-opts":t.sizeOpts,"show-elevator":!0,"show-sizer":!0},on:{"on-page-size-change":t.handleSizeChange,"on-change":t.handleCurrentChange}})],1)]),t._v(" "),a("Modal",{attrs:{title:t.myFormTitle},on:{"on-ok":t.submitMyForm,"on-cancel":t.closeForm},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[a("div",{staticClass:"pit-dialog-edit-form"},[a("Form",{ref:"myForm",staticClass:"myForm",attrs:{rules:t.myRules,"label-width":100,model:t.myForm}},[a("FormItem",{attrs:{label:"名称",prop:"name"}},[a("Input",{attrs:{"auto-complete":"off"},model:{value:t.myForm.name,callback:function(e){t.$set(t.myForm,"name",e)},expression:"myForm.name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"链接"}},[a("Input",{attrs:{"auto-complete":"off"},model:{value:t.myForm.url,callback:function(e){t.$set(t.myForm,"url",e)},expression:"myForm.url"}})],1),t._v(" "),a("FormItem",{attrs:{label:"E-Mail",prop:"email"}},[a("Input",{attrs:{"auto-complete":"off"},model:{value:t.myForm.email,callback:function(e){t.$set(t.myForm,"email",e)},expression:"myForm.email"}})],1),t._v(" "),a("FormItem",{attrs:{label:"内容",prop:"markdown"}},[a("Input",{attrs:{type:"textarea",autosize:"","auto-complete":"off"},model:{value:t.myForm.markdown,callback:function(e){t.$set(t.myForm,"markdown",e)},expression:"myForm.markdown"}})],1),t._v(" "),t.myForm.id?a("FormItem",[a("Input",{staticStyle:{display:"none"},model:{value:t.myForm.id,callback:function(e){t.$set(t.myForm,"id",e)},expression:"myForm.id"}})],1):t._e()],1),t._v(" "),t.editFormLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)])],1)},o=[],i={render:n,staticRenderFns:o};e.default=i}});