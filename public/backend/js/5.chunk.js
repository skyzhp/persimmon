webpackJsonp([5],{390:function(t,e,a){"use strict";function i(t){a(469)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(412),o=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);var r=a(471),l=a.n(r),c=a(6),d=i,m=c(o.a,l.a,!1,d,null,null);e.default=m.exports},412:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(19),n=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){var t=this;return{listData:[],categorys:[],currentPage:1,total:0,pageSize:20,myForm:{id:0,tags_name:"",tags_flag:""},myRules:{tags_name:[{required:!0,type:"string",message:"请填写标签名称",trigger:"blur"}],tags_flag:[{required:!0,type:"string",message:"请填写标签别名",trigger:"blur"}]},editFormVisible:!1,editFormLoading:!1,listLoading:!1,myFormTitle:"编辑",checkedAll:[],sizeOpts:[10,20,30,40,50,60,70,80,90,100],tableColumns:[{type:"selection",width:60,align:"center"},{title:"标签名",key:"tags_name"},{title:"uri",key:"tags_flag"},{title:"日期",key:"created_at",render:function(t,e){return t("span",n.default.timeFormat(e.row.created_at))}},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleEdit(a.row)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.handleDistory("one",a.row)}}},"删除")])}}]}},methods:{formatterFlag:function(t,e){return""==t.tags_flag?"":decodeURI(t.tags_flag)},getData:function(){var t=this;t.listLoading=!0,n.default.ajax.get("/backend/tags",{params:{rows:this.pageSize,page:this.currentPage}}).then(function(e){var a=e.data;200==a.status?(t.listData=a.list.data,t.total=a.list.total,t.currentPage=a.list.current_page,t.listLoading=!1):t.$Notice.warning({title:"数据获取失败",desc:""})}).catch(function(t){console.log(t)})},handleSizeChange:function(t){this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleCreate:function(){var t=this;t.myFormTitle="新增",t.myForm.id=0,t.editFormVisible=!0,t.setTopCategorys()},handleEdit:function(t){var e=this;e.setTopCategorys(),e.editFormLoading=!0,e.myFormTitle="编辑",e.editFormVisible=!0,n.default.ajax.get("/backend/tags/"+t.id).then(function(t){var a=t.data;200==a.status?(a.tags_flag=decodeURI(a.item.tags_flag),e.myForm=a.item):e.$Notice.warning({title:"数据获取失败",desc:""}),e.editFormLoading=!1}).catch(function(t){console.log(t),e.editFormLoading=!1})},handleDistory:function(t,e){var a=this,i={};switch(t){case"one":if(parseInt(e.id)<=0)return a.$Notice.warning({title:"请选择需要删除的数据",desc:""}),!1;i={ids:[e.id]};break;case"multi":var o=a.util.getIdByArr(a.checkedAll);if(o.length<=0)return a.$Notice.warning({title:"请选择需要删除的数据",desc:""}),!1;i={ids:o}}a.$Modal.confirm({title:"确认删除选中的记录吗?",content:"<p>您确认删除选中的记录吗?</p>",onOk:function(){a.listLoading=!0,n.default.ajax.post("/backend/tags/destroy",n.default.stringify(i)).then(function(i){a.listLoading=!1;var n=i.data;if(a.$Notice.open({title:200==n.status?"删除成功":"删除失败",desc:""}),"one"==t)a.util.removeByValue(a.listData,e.id);else for(var o in a.checkedAll)a.util.removeByValue(a.listData,a.checkedAll[o].id)}).catch(function(t){console.log(t)})},onCancel:function(){a.listLoading=!1}})},submitMyForm:function(){var t=this;t.$refs.myForm.validate(function(e){if(!e)return console.log("myForm valid error."),!1;t.myForm.id>0?n.default.ajax.put("/backend/tags/update",t.myForm).then(function(e){var a=e.data;t.$message({message:200==a.status?"编辑成功":"编辑失败",type:a.status}),200==a.status&&(t.closeForm("myForm"),t.getData())}).catch(function(t){console.log(t)}):n.default.ajax.post("/backend/tags/store",t.myForm).then(function(e){var a=e.data;200==a.status&&(t.closeForm("myForm"),t.getData()),t.$Notice.open({title:200==a.status?"新增成功":"新增失败",desc:""})}).catch(function(e){if(e.response){if(422==e.response.status)for(var a in e.response.data)t.$Notice.warning({title:"警告",desc:e.response.data[a][0]})}else console.log(e)})})},closeForm:function(){this.editFormVisible=!1,this.$refs.myForm.resetFields(),this.myForm={id:0,tags_name:"",tags_flag:""},console.log("closeForm")},selectRow:function(t){this.checkedAll=t},selectAll:function(t){this.checkedAll=t},setTopCategorys:function(){var t=this.listData.concat();t.splice(0,0,{id:0,category_name:"顶级分类",hidden:!0,category_parent:0}),this.categorys=t},translateWords:function(t){var e=this,a=e.myForm.tags_name;if(null!=a.match(/\w+/g)&&(e.myForm.flag=a),null==a||""==a)return!1;n.default.ajax.get("/backend/utils/fanyi/"+a).then(function(t){var a=t.data;200==a.status&&(e.myForm.tags_flag=a.item)}).catch(function(t){console.log(t)})}},watch:{"myForm.tags_name":{handler:function(t,e){this.myForm.tags_flag=t.replace(" ","-")},deep:!0}},mounted:function(){this.getData()}}},469:function(t,e,a){var i=a(470);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(23)("85be36de",i,!0,{})},470:function(t,e,a){e=t.exports=a(22)(!1),e.push([t.i,"",""])},471:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pit-content"},[a("div",{staticClass:"pit-action-btn"},[a("Button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleCreate}},[t._v("新增")]),t._v(" "),a("Button",{attrs:{type:"primary",icon:"delete"},on:{click:function(e){t.handleDistory("multi",{})}}},[t._v("删除")])],1),t._v(" "),a("div",{staticClass:"data-list"},[a("Table",{attrs:{loading:t.listLoading,columns:t.tableColumns,data:t.listData,stripe:""},on:{"on-select":t.selectRow,"on-select-all":t.selectAll}})],1),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"myp-page",attrs:{total:t.total,"page-size":t.pageSize,current:t.currentPage,"page-size-opts":t.sizeOpts,"show-elevator":!0,"show-sizer":!0},on:{"on-page-size-change":t.handleSizeChange,"on-change":t.handleCurrentChange}})],1)]),t._v(" "),a("Modal",{attrs:{title:t.myFormTitle},on:{"on-ok":t.submitMyForm,"on-cancel":t.closeForm},model:{value:t.editFormVisible,callback:function(e){t.editFormVisible=e},expression:"editFormVisible"}},[a("div",{staticClass:"pit-dialog-edit-form"},[a("Form",{ref:"myForm",staticClass:"myForm",attrs:{rules:t.myRules,"label-width":100,model:t.myForm}},[a("FormItem",{attrs:{label:"标签名称",prop:"tags_name"}},[a("Input",{attrs:{"auto-complete":"off"},on:{"on-blur":t.translateWords,"on-enter":t.translateWords},model:{value:t.myForm.tags_name,callback:function(e){t.$set(t.myForm,"tags_name",e)},expression:"myForm.tags_name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"标签别名",prop:"tags_flag"}},[a("Input",{attrs:{"auto-complete":"off"},model:{value:t.myForm.tags_flag,callback:function(e){t.$set(t.myForm,"tags_flag",e)},expression:"myForm.tags_flag"}})],1),t._v(" "),t.myForm.id?a("FormItem",[a("Input",{staticStyle:{display:"none"},model:{value:t.myForm.id,callback:function(e){t.$set(t.myForm,"id",e)},expression:"myForm.id"}})],1):t._e()],1),t._v(" "),t.editFormLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)])],1)},n=[],o={render:i,staticRenderFns:n};e.default=o}});